{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ALOK\\\\OneDrive\\\\Desktop\\\\AI parking detctor\\\\frontend\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport axios from 'axios';\nimport L from 'leaflet';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport 'leaflet/dist/leaflet.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Dashboard() {\n  _s();\n  const [parkingSpots, setParkingSpots] = useState([]);\n  const [loadingSpotId, setLoadingSpotId] = useState(null);\n  useEffect(() => {\n    fetchSpots();\n  }, []);\n  const fetchSpots = async () => {\n    try {\n      const res = await axios.get('http://localhost:5000/api/spots');\n      setParkingSpots(res.data);\n    } catch (err) {\n      console.error('Error fetching parking spots:', err);\n    }\n  };\n  const handleBooking = async spotId => {\n    const confirmBooking = window.confirm('Do you want to book this spot?');\n    if (!confirmBooking) return;\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        toast.error('Please log in to book a spot.');\n        return;\n      }\n      setLoadingSpotId(spotId);\n      const res = await axios.post('http://localhost:5000/api/bookings', {\n        spotId\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      toast.success('Booking successful!');\n      fetchSpots(); // Refresh spots\n    } catch (err) {\n      console.error('Error booking spot:', err);\n      toast.error('Booking failed. Try again.');\n    } finally {\n      setLoadingSpotId(null);\n    }\n  };\n  const customMarkerIcon = availableSlots => {\n    return new L.Icon({\n      iconUrl: availableSlots > 0 ? 'https://cdn-icons-png.flaticon.com/512/684/684908.png' // Green car icon\n      : 'https://cdn-icons-png.flaticon.com/512/684/684908-gray.png',\n      // Gray car for full\n      iconSize: [35, 35]\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '90vh',\n      width: '100%',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [28.6448, 77.216721],\n      zoom: 13,\n      style: {\n        height: '100%',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 OpenStreetMap contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), parkingSpots.map(spot => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [spot.latitude, spot.longitude],\n        icon: customMarkerIcon(spot.availableSlots),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                margin: '5px 0'\n              },\n              children: spot.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: '5px 0'\n              },\n              children: spot.city\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: '5px 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Slots:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 19\n              }, this), \" \", spot.availableSlots, \"/\", spot.totalSlots]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 17\n            }, this), spot.availableSlots > 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleBooking(spot._id),\n              disabled: loadingSpotId === spot._id,\n              style: {\n                backgroundColor: '#4CAF50',\n                color: 'white',\n                padding: '8px 12px',\n                border: 'none',\n                borderRadius: '5px',\n                cursor: 'pointer',\n                marginTop: '5px'\n              },\n              children: loadingSpotId === spot._id ? 'Booking...' : 'Book Now'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              disabled: true,\n              style: {\n                backgroundColor: 'gray',\n                color: 'white',\n                padding: '8px 12px',\n                border: 'none',\n                borderRadius: '5px',\n                marginTop: '5px'\n              },\n              children: \"No Slots Available\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }, this)\n      }, spot._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"6j0i/yg3tLtFfcaM46NKyiXfmuc=\");\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","MapContainer","TileLayer","Marker","Popup","axios","L","ToastContainer","toast","jsxDEV","_jsxDEV","Dashboard","_s","parkingSpots","setParkingSpots","loadingSpotId","setLoadingSpotId","fetchSpots","res","get","data","err","console","error","handleBooking","spotId","confirmBooking","window","confirm","token","localStorage","getItem","post","headers","Authorization","success","customMarkerIcon","availableSlots","Icon","iconUrl","iconSize","style","height","width","position","children","fileName","_jsxFileName","lineNumber","columnNumber","center","zoom","attribution","url","map","spot","latitude","longitude","icon","textAlign","margin","name","city","totalSlots","onClick","_id","disabled","backgroundColor","color","padding","border","borderRadius","cursor","marginTop","_c","$RefreshReg$"],"sources":["C:/Users/ALOK/OneDrive/Desktop/AI parking detctor/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\r\nimport axios from 'axios';\r\nimport L from 'leaflet';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\nfunction Dashboard() {\r\n  const [parkingSpots, setParkingSpots] = useState([]);\r\n  const [loadingSpotId, setLoadingSpotId] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchSpots();\r\n  }, []);\r\n\r\n  const fetchSpots = async () => {\r\n    try {\r\n      const res = await axios.get('http://localhost:5000/api/spots');\r\n      setParkingSpots(res.data);\r\n    } catch (err) {\r\n      console.error('Error fetching parking spots:', err);\r\n    }\r\n  };\r\n\r\n  const handleBooking = async (spotId) => {\r\n    const confirmBooking = window.confirm('Do you want to book this spot?');\r\n    if (!confirmBooking) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        toast.error('Please log in to book a spot.');\r\n        return;\r\n      }\r\n\r\n      setLoadingSpotId(spotId);\r\n\r\n      const res = await axios.post(\r\n        'http://localhost:5000/api/bookings',\r\n        { spotId },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      toast.success('Booking successful!');\r\n      fetchSpots(); // Refresh spots\r\n    } catch (err) {\r\n      console.error('Error booking spot:', err);\r\n      toast.error('Booking failed. Try again.');\r\n    } finally {\r\n      setLoadingSpotId(null);\r\n    }\r\n  };\r\n\r\n  const customMarkerIcon = (availableSlots) => {\r\n    return new L.Icon({\r\n      iconUrl: availableSlots > 0\r\n        ? 'https://cdn-icons-png.flaticon.com/512/684/684908.png' // Green car icon\r\n        : 'https://cdn-icons-png.flaticon.com/512/684/684908-gray.png', // Gray car for full\r\n      iconSize: [35, 35],\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div style={{ height: '90vh', width: '100%', position: 'relative' }}>\r\n      <ToastContainer />\r\n      <MapContainer center={[28.6448, 77.216721]} zoom={13} style={{ height: '100%', width: '100%' }}>\r\n        <TileLayer\r\n          attribution='&copy; OpenStreetMap contributors'\r\n          url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\r\n        />\r\n        {parkingSpots.map((spot) => (\r\n          <Marker\r\n            key={spot._id}\r\n            position={[spot.latitude, spot.longitude]}\r\n            icon={customMarkerIcon(spot.availableSlots)}\r\n          >\r\n            <Popup>\r\n              <div style={{ textAlign: 'center' }}>\r\n                <h3 style={{ margin: '5px 0' }}>{spot.name}</h3>\r\n                <p style={{ margin: '5px 0' }}>{spot.city}</p>\r\n                <p style={{ margin: '5px 0' }}>\r\n                  <strong>Slots:</strong> {spot.availableSlots}/{spot.totalSlots}\r\n                </p>\r\n\r\n                {spot.availableSlots > 0 ? (\r\n                  <button\r\n                    onClick={() => handleBooking(spot._id)}\r\n                    disabled={loadingSpotId === spot._id}\r\n                    style={{\r\n                      backgroundColor: '#4CAF50',\r\n                      color: 'white',\r\n                      padding: '8px 12px',\r\n                      border: 'none',\r\n                      borderRadius: '5px',\r\n                      cursor: 'pointer',\r\n                      marginTop: '5px',\r\n                    }}\r\n                  >\r\n                    {loadingSpotId === spot._id ? 'Booking...' : 'Book Now'}\r\n                  </button>\r\n                ) : (\r\n                  <button\r\n                    disabled\r\n                    style={{\r\n                      backgroundColor: 'gray',\r\n                      color: 'white',\r\n                      padding: '8px 12px',\r\n                      border: 'none',\r\n                      borderRadius: '5px',\r\n                      marginTop: '5px',\r\n                    }}\r\n                  >\r\n                    No Slots Available\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </Popup>\r\n          </Marker>\r\n        ))}\r\n      </MapContainer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,KAAK,QAAQ,eAAe;AACtE,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,CAAC,MAAM,SAAS;AACvB,SAASC,cAAc,EAAEC,KAAK,QAAQ,gBAAgB;AACtD,OAAO,uCAAuC;AAC9C,OAAO,0BAA0B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAElC,SAASC,SAASA,CAAA,EAAG;EAAAC,EAAA;EACnB,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACe,aAAa,EAAEC,gBAAgB,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAExDD,SAAS,CAAC,MAAM;IACdkB,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMA,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI;MACF,MAAMC,GAAG,GAAG,MAAMb,KAAK,CAACc,GAAG,CAAC,iCAAiC,CAAC;MAC9DL,eAAe,CAACI,GAAG,CAACE,IAAI,CAAC;IAC3B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEF,GAAG,CAAC;IACrD;EACF,CAAC;EAED,MAAMG,aAAa,GAAG,MAAOC,MAAM,IAAK;IACtC,MAAMC,cAAc,GAAGC,MAAM,CAACC,OAAO,CAAC,gCAAgC,CAAC;IACvE,IAAI,CAACF,cAAc,EAAE;IAErB,IAAI;MACF,MAAMG,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACF,KAAK,EAAE;QACVrB,KAAK,CAACe,KAAK,CAAC,+BAA+B,CAAC;QAC5C;MACF;MAEAP,gBAAgB,CAACS,MAAM,CAAC;MAExB,MAAMP,GAAG,GAAG,MAAMb,KAAK,CAAC2B,IAAI,CAC1B,oCAAoC,EACpC;QAAEP;MAAO,CAAC,EACV;QACEQ,OAAO,EAAE;UACPC,aAAa,EAAE,UAAUL,KAAK;QAChC;MACF,CACF,CAAC;MAEDrB,KAAK,CAAC2B,OAAO,CAAC,qBAAqB,CAAC;MACpClB,UAAU,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,OAAOI,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEF,GAAG,CAAC;MACzCb,KAAK,CAACe,KAAK,CAAC,4BAA4B,CAAC;IAC3C,CAAC,SAAS;MACRP,gBAAgB,CAAC,IAAI,CAAC;IACxB;EACF,CAAC;EAED,MAAMoB,gBAAgB,GAAIC,cAAc,IAAK;IAC3C,OAAO,IAAI/B,CAAC,CAACgC,IAAI,CAAC;MAChBC,OAAO,EAAEF,cAAc,GAAG,CAAC,GACvB,uDAAuD,CAAC;MAAA,EACxD,4DAA4D;MAAE;MAClEG,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE;IACnB,CAAC,CAAC;EACJ,CAAC;EAED,oBACE9B,OAAA;IAAK+B,KAAK,EAAE;MAAEC,MAAM,EAAE,MAAM;MAAEC,KAAK,EAAE,MAAM;MAAEC,QAAQ,EAAE;IAAW,CAAE;IAAAC,QAAA,gBAClEnC,OAAA,CAACH,cAAc;MAAAuC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAClBvC,OAAA,CAACT,YAAY;MAACiD,MAAM,EAAE,CAAC,OAAO,EAAE,SAAS,CAAE;MAACC,IAAI,EAAE,EAAG;MAACV,KAAK,EAAE;QAAEC,MAAM,EAAE,MAAM;QAAEC,KAAK,EAAE;MAAO,CAAE;MAAAE,QAAA,gBAC7FnC,OAAA,CAACR,SAAS;QACRkD,WAAW,EAAC,iCAAmC;QAC/CC,GAAG,EAAC;MAAoD;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzD,CAAC,EACDpC,YAAY,CAACyC,GAAG,CAAEC,IAAI,iBACrB7C,OAAA,CAACP,MAAM;QAELyC,QAAQ,EAAE,CAACW,IAAI,CAACC,QAAQ,EAAED,IAAI,CAACE,SAAS,CAAE;QAC1CC,IAAI,EAAEtB,gBAAgB,CAACmB,IAAI,CAAClB,cAAc,CAAE;QAAAQ,QAAA,eAE5CnC,OAAA,CAACN,KAAK;UAAAyC,QAAA,eACJnC,OAAA;YAAK+B,KAAK,EAAE;cAAEkB,SAAS,EAAE;YAAS,CAAE;YAAAd,QAAA,gBAClCnC,OAAA;cAAI+B,KAAK,EAAE;gBAAEmB,MAAM,EAAE;cAAQ,CAAE;cAAAf,QAAA,EAAEU,IAAI,CAACM;YAAI;cAAAf,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAChDvC,OAAA;cAAG+B,KAAK,EAAE;gBAAEmB,MAAM,EAAE;cAAQ,CAAE;cAAAf,QAAA,EAAEU,IAAI,CAACO;YAAI;cAAAhB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC9CvC,OAAA;cAAG+B,KAAK,EAAE;gBAAEmB,MAAM,EAAE;cAAQ,CAAE;cAAAf,QAAA,gBAC5BnC,OAAA;gBAAAmC,QAAA,EAAQ;cAAM;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACM,IAAI,CAAClB,cAAc,EAAC,GAAC,EAACkB,IAAI,CAACQ,UAAU;YAAA;cAAAjB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC7D,CAAC,EAEHM,IAAI,CAAClB,cAAc,GAAG,CAAC,gBACtB3B,OAAA;cACEsD,OAAO,EAAEA,CAAA,KAAMxC,aAAa,CAAC+B,IAAI,CAACU,GAAG,CAAE;cACvCC,QAAQ,EAAEnD,aAAa,KAAKwC,IAAI,CAACU,GAAI;cACrCxB,KAAK,EAAE;gBACL0B,eAAe,EAAE,SAAS;gBAC1BC,KAAK,EAAE,OAAO;gBACdC,OAAO,EAAE,UAAU;gBACnBC,MAAM,EAAE,MAAM;gBACdC,YAAY,EAAE,KAAK;gBACnBC,MAAM,EAAE,SAAS;gBACjBC,SAAS,EAAE;cACb,CAAE;cAAA5B,QAAA,EAED9B,aAAa,KAAKwC,IAAI,CAACU,GAAG,GAAG,YAAY,GAAG;YAAU;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjD,CAAC,gBAETvC,OAAA;cACEwD,QAAQ;cACRzB,KAAK,EAAE;gBACL0B,eAAe,EAAE,MAAM;gBACvBC,KAAK,EAAE,OAAO;gBACdC,OAAO,EAAE,UAAU;gBACnBC,MAAM,EAAE,MAAM;gBACdC,YAAY,EAAE,KAAK;gBACnBE,SAAS,EAAE;cACb,CAAE;cAAA5B,QAAA,EACH;YAED;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CACT;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD;MAAC,GA5CHM,IAAI,CAACU,GAAG;QAAAnB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OA6CP,CACT,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACU,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACZ,CAAC;AAEV;AAACrC,EAAA,CAvHQD,SAAS;AAAA+D,EAAA,GAAT/D,SAAS;AAyHlB,eAAeA,SAAS;AAAC,IAAA+D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}